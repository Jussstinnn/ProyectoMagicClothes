<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <title>Vestidos</title>
        <link rel="stylesheet" th:href="@{/css/estilos.css}" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    </head>
    <body>

        <!-- Fragmento que se usar√° en plantilla.html -->
        <div th:fragment="body_content">


                <!-- üîç Buscador + Filtros -->
                <header class="site-header py-4">
                    <div class="container d-flex justify-content-between align-items-center flex-wrap gap-3">

                        <div class="logo">LOGO</div>

                        <!-- B√∫squeda + Filtros centrado -->
                        <div class="d-flex align-items-center flex-wrap justify-content-center gap-2">
                            <form th:action="@{/productos/buscar}" method="get" class="d-flex align-items-center flex-wrap gap-2">
                                <input class="form-control" name="keyword" placeholder="Buscar productos" type="text" style="width: 250px;" />

                                <div class="dropdown">
                                    <button class="btn btn-outline-dark dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                        üîé Filtros
                                    </button>
                                    <div class="dropdown-menu p-4" style="min-width: 300px;">
                                        <div class="mb-3">
                                            <label class="form-label">Condici√≥n</label>
                                            <select name="estado" class="form-select">
                                                <option value="">Todos</option>
                                                <option value="nuevo">Nuevo</option>
                                                <option value="usado">Usado</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Categor√≠a</label>
                                            <select name="categoria" class="form-select">
                                                <option value="">Todas</option>
                                                <option value="camisas">Camisas</option>
                                                <option value="pantalones">Pantalones</option>
                                                <option value="vestidos">Vestidos</option>
                                                <option value="accesorios">Accesorios</option>
                                                <option value="conjuntos">Conjuntos</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Precio</label>
                                            <select name="precioRango" class="form-select">
                                                <option value="">Todos</option>
                                                <option value="menos10">Menos de ‚Ç°10,000</option>
                                                <option value="entre10y20">‚Ç°10,000 a ‚Ç°20,000</option>
                                                <option value="mas20">M√°s de ‚Ç°20,000</option>
                                            </select>
                                        </div>
                                        <div class="text-end">
                                            <button type="submit" class="btn btn-dark">Aplicar filtros</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="header-buttons d-flex gap-2">
                            <button class="btn btn-outline-secondary btn-sm">Reportar problema</button>

                            <div sec:authorize="isAnonymous()">
                                <a href="/login" class="btn btn-outline-secondary btn-sm">Iniciar Sesi√≥n</a>
                                <a href="/registro" class="btn btn-outline-secondary btn-sm">Crear cuenta</a>
                            </div>

                            <div sec:authorize="isAuthenticated()" class="d-flex align-items-center gap-2">
                                <span class="text-dark" th:text="${#authentication.name}">correo@ejemplo.com</span>
                                <form th:action="@{/logout}" method="post" style="display:inline;">
                                    <button type="submit" class="btn btn-outline-secondary btn-sm">Cerrar sesi√≥n</button>
                                </form>
                            </div>

                            <button class="btn btn-outline-secondary btn-sm" onclick="location.href = '/pago'">Ir a pago</button>
                            <button class="btn btn-outline-secondary btn-sm" onclick="location.href = '/historialCompra'">Historial compra</button>
                        </div>

                    </div>
                </header>

                <!-- Men√∫ -->
                <div th:replace="fragments/menu :: menu"></div>

                <!-- T√≠tulo -->
                <h1 class="text-center my-4">Vestidos</h1>

                <!-- Validaci√≥n si no hay productos -->
                <h2 th:if="${#lists.isEmpty(vestidos)}" class="text-center text-warning">‚ö†Ô∏è No hay vestidos en la base de datos</h2>

                <!-- Productos -->
                <section class="products d-flex flex-wrap gap-4 justify-content-center p-4">
                    <div th:each="vestido, iterStat : ${vestidos}" style="display: contents;">

                        <!-- Tarjeta individual -->
                        <div class="card shadow-sm" style="width: 250px; border-radius: 8px;">
                            <img th:src="${vestido.imagen}" alt="Imagen" class="card-img-top" style="height: 250px; object-fit: cover; border-top-left-radius: 8px; border-top-right-radius: 8px;">
                            <div class="card-body d-flex flex-column justify-content-between">
                                <h5 class="card-title" th:text="${vestido.nombre}" style="min-height: 48px;">Nombre</h5>
                                <p class="text-success fw-bold mb-1" th:text="'‚Ç°' + ${vestido.precio}">‚Ç°0.00</p>
                                <p class="text-muted mb-2" th:text="${vestido.descripcion}" style="min-height: 60px;">Descripci√≥n</p>
                                <a class="btn btn-primary mt-auto w-100" th:href="@{'/vestidos/' + ${vestido.id}}">Ver Detalles</a>
                            </div>
                        </div>

                        <!-- Salto de fila cada 5 productos -->
                        <div th:if="${iterStat.index % 5 == 4}" style="flex-basis: 100%; height: 0;"></div>

                    </div>
                </section>

        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>


